<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DandDy - Demo Mode (No Login Required)</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Demo data stored in browser's localStorage
        const STORAGE_KEY = 'dandy_demo_characters';

        const getSampleCharacters = () => {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                return JSON.parse(stored);
            }
            // Default sample characters
            return [
                {
                    id: 1,
                    name: "Thorin Ironshield",
                    race: "Dwarf",
                    character_class: "Fighter",
                    level: 5,
                    strength: 16,
                    dexterity: 12,
                    constitution: 15,
                    intelligence: 10,
                    wisdom: 13,
                    charisma: 8,
                    hit_points_max: 45,
                    hit_points_current: 38,
                    armor_class: 18,
                    initiative: 1,
                    speed: 25,
                    conditions: []
                },
                {
                    id: 2,
                    name: "Lyra Moonwhisper",
                    race: "Elf",
                    character_class: "Wizard",
                    level: 4,
                    strength: 8,
                    dexterity: 14,
                    constitution: 12,
                    intelligence: 18,
                    wisdom: 13,
                    charisma: 11,
                    hit_points_max: 24,
                    hit_points_current: 24,
                    armor_class: 12,
                    initiative: 2,
                    speed: 30,
                    conditions: []
                },
                {
                    id: 3,
                    name: "Grimjaw",
                    race: "Half-Orc",
                    character_class: "Barbarian",
                    level: 6,
                    strength: 18,
                    dexterity: 14,
                    constitution: 16,
                    intelligence: 8,
                    wisdom: 10,
                    charisma: 10,
                    hit_points_max: 62,
                    hit_points_current: 15,
                    armor_class: 14,
                    initiative: 2,
                    speed: 40,
                    conditions: ["Poisoned"]
                }
            ];
        };

        const saveCharacters = (characters) => {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(characters));
        };

        // Dashboard Component
        function Dashboard() {
            const [characters, setCharacters] = useState(getSampleCharacters());
            const [showCreate, setShowCreate] = useState(false);
            const [selectedCharacter, setSelectedCharacter] = useState(null);

            useEffect(() => {
                saveCharacters(characters);
            }, [characters]);

            const handleDelete = (id, name) => {
                if (confirm(`Delete ${name}?`)) {
                    setCharacters(characters.filter(c => c.id !== id));
                }
            };

            const updateCharacter = (id, updates) => {
                setCharacters(characters.map(c => 
                    c.id === id ? { ...c, ...updates } : c
                ));
                if (selectedCharacter?.id === id) {
                    setSelectedCharacter({ ...selectedCharacter, ...updates });
                }
            };

            if (selectedCharacter) {
                return (
                    <CharacterSheet 
                        character={selectedCharacter} 
                        onBack={() => setSelectedCharacter(null)}
                        onUpdate={(updates) => updateCharacter(selectedCharacter.id, updates)}
                    />
                );
            }

            if (showCreate) {
                return (
                    <CreateCharacter 
                        onBack={() => setShowCreate(false)} 
                        onCreate={(newChar) => {
                            const id = Math.max(0, ...characters.map(c => c.id)) + 1;
                            setCharacters([...characters, { ...newChar, id }]);
                            setShowCreate(false);
                        }}
                    />
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    <nav className="bg-white shadow-sm border-b border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex justify-between items-center">
                                <div className="flex items-center space-x-3">
                                    <span className="text-2xl">üõ°Ô∏è</span>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900">DandDy</h1>
                                        <p className="text-xs text-gray-500">Demo Mode - No Login Required</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-4">
                                    <span className="px-3 py-1 text-xs bg-green-100 text-green-700 rounded-full">
                                        ‚úì Demo User
                                    </span>
                                </div>
                            </div>
                        </div>
                    </nav>

                    <main className="max-w-7xl mx-auto px-4 py-8">
                        <div className="flex justify-between items-center mb-8">
                            <div>
                                <h2 className="text-3xl font-bold text-gray-900">My Characters</h2>
                                <p className="text-gray-600 mt-1">All data saved in your browser</p>
                            </div>
                            <button
                                onClick={() => setShowCreate(true)}
                                className="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700"
                            >
                                + New Character
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {characters.map(character => (
                                <div key={character.id} className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer" onClick={() => setSelectedCharacter(character)}>
                                    <div className="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 className="text-xl font-bold text-gray-900">{character.name}</h3>
                                            <p className="text-sm text-gray-600">{character.race} {character.character_class}</p>
                                        </div>
                                        <span className="px-3 py-1 bg-blue-100 text-blue-700 text-sm font-bold rounded-full">
                                            Lv {character.level}
                                        </span>
                                    </div>

                                    <div className="mb-4">
                                        <div className="flex justify-between text-sm mb-1">
                                            <span className="font-medium text-gray-700">HP</span>
                                            <span className={`font-bold ${
                                                character.hit_points_current / character.hit_points_max > 0.5 ? 'text-green-600' :
                                                character.hit_points_current / character.hit_points_max > 0.25 ? 'text-orange-600' : 'text-red-600'
                                            }`}>
                                                {character.hit_points_current}/{character.hit_points_max}
                                            </span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2">
                                            <div
                                                className={`h-2 rounded-full ${
                                                    character.hit_points_current / character.hit_points_max > 0.5 ? 'bg-green-500' :
                                                    character.hit_points_current / character.hit_points_max > 0.25 ? 'bg-orange-500' : 'bg-red-500'
                                                }`}
                                                style={{ width: `${(character.hit_points_current / character.hit_points_max) * 100}%` }}
                                            />
                                        </div>
                                    </div>

                                    <div className="flex justify-between text-sm mb-4">
                                        <span>üõ°Ô∏è AC {character.armor_class}</span>
                                        <span>‚ö° Init {character.initiative >= 0 ? '+' : ''}{character.initiative}</span>
                                        <span>üí® {character.speed}ft</span>
                                    </div>

                                    {character.conditions.length > 0 && (
                                        <div className="mb-2">
                                            {character.conditions.map(c => (
                                                <span key={c} className="inline-block px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded mr-1">
                                                    {c}
                                                </span>
                                            ))}
                                        </div>
                                    )}

                                    <button
                                        onClick={(e) => {
                                            e.stopPropagation();
                                            handleDelete(character.id, character.name);
                                        }}
                                        className="w-full px-4 py-2 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100"
                                    >
                                        Delete
                                    </button>
                                </div>
                            ))}
                        </div>

                        {characters.length === 0 && (
                            <div className="bg-white rounded-lg shadow-md p-12 text-center">
                                <div className="text-6xl mb-4">‚öîÔ∏è</div>
                                <h3 className="text-xl font-bold text-gray-900 mb-2">No Characters Yet</h3>
                                <p className="text-gray-600 mb-6">Create your first character to begin</p>
                                <button
                                    onClick={() => setShowCreate(true)}
                                    className="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700"
                                >
                                    Create Character
                                </button>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        // Character Sheet Component
        function CharacterSheet({ character, onBack, onUpdate }) {
            const [damageAmount, setDamageAmount] = useState('');
            const [healAmount, setHealAmount] = useState('');

            const mod = (score) => Math.floor((score - 10) / 2);

            const handleDamage = () => {
                const damage = parseInt(damageAmount);
                if (damage > 0) {
                    const newHP = Math.max(0, character.hit_points_current - damage);
                    onUpdate({ hit_points_current: newHP });
                    setDamageAmount('');
                }
            };

            const handleHeal = () => {
                const heal = parseInt(healAmount);
                if (heal > 0) {
                    const newHP = Math.min(character.hit_points_max, character.hit_points_current + heal);
                    onUpdate({ hit_points_current: newHP });
                    setHealAmount('');
                }
            };

            return (
                <div className="min-h-screen bg-gray-50 py-8">
                    <div className="max-w-6xl mx-auto px-4">
                        <button onClick={onBack} className="mb-6 px-4 py-2 text-gray-600 hover:text-gray-900">
                            ‚Üê Back to Characters
                        </button>

                        <div className="flex justify-between items-start mb-8">
                            <div>
                                <h1 className="text-4xl font-bold text-gray-900">{character.name}</h1>
                                <p className="text-xl text-gray-600">
                                    Level {character.level} {character.race} {character.character_class}
                                </p>
                            </div>
                            <div className="flex space-x-6">
                                <div className="text-center">
                                    <div className="text-3xl font-bold text-gray-900">{character.armor_class}</div>
                                    <div className="text-sm text-gray-600">AC</div>
                                </div>
                                <div className="text-center">
                                    <div className="text-3xl font-bold text-gray-900">{character.initiative >= 0 ? '+' : ''}{character.initiative}</div>
                                    <div className="text-sm text-gray-600">Initiative</div>
                                </div>
                                <div className="text-center">
                                    <div className="text-3xl font-bold text-gray-900">{character.speed}</div>
                                    <div className="text-sm text-gray-600">Speed</div>
                                </div>
                            </div>
                        </div>

                        {/* HP Management */}
                        <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-2xl font-bold">Hit Points</h2>
                                <span className="text-4xl font-bold text-gray-900">
                                    {character.hit_points_current}/{character.hit_points_max}
                                </span>
                            </div>

                            <div className="w-full bg-gray-200 rounded-full h-6 mb-6">
                                <div
                                    className={`h-6 rounded-full transition-all ${
                                        character.hit_points_current / character.hit_points_max > 0.5 ? 'bg-green-500' :
                                        character.hit_points_current / character.hit_points_max > 0.25 ? 'bg-orange-500' : 'bg-red-500'
                                    }`}
                                    style={{ width: `${(character.hit_points_current / character.hit_points_max) * 100}%` }}
                                />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="flex space-x-2">
                                    <input
                                        type="number"
                                        placeholder="Damage"
                                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg"
                                        value={damageAmount}
                                        onChange={(e) => setDamageAmount(e.target.value)}
                                    />
                                    <button onClick={handleDamage} className="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                                        Take Damage
                                    </button>
                                </div>

                                <div className="flex space-x-2">
                                    <input
                                        type="number"
                                        placeholder="Heal"
                                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg"
                                        value={healAmount}
                                        onChange={(e) => setHealAmount(e.target.value)}
                                    />
                                    <button onClick={handleHeal} className="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                        Heal
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Ability Scores */}
                        <div className="bg-white rounded-lg shadow-md p-6">
                            <h2 className="text-2xl font-bold mb-6">Ability Scores</h2>
                            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                                {[
                                    { label: 'STR', value: character.strength },
                                    { label: 'DEX', value: character.dexterity },
                                    { label: 'CON', value: character.constitution },
                                    { label: 'INT', value: character.intelligence },
                                    { label: 'WIS', value: character.wisdom },
                                    { label: 'CHA', value: character.charisma }
                                ].map(ability => (
                                    <div key={ability.label} className="text-center p-4 bg-gray-50 rounded-lg">
                                        <div className="text-xs font-medium text-gray-600 mb-1">{ability.label}</div>
                                        <div className="text-3xl font-bold text-blue-600">
                                            {mod(ability.value) >= 0 ? '+' : ''}{mod(ability.value)}
                                        </div>
                                        <div className="text-sm text-gray-600">{ability.value}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Create Character Component
        function CreateCharacter({ onBack, onCreate }) {
            const [name, setName] = useState('');
            const [race, setRace] = useState('Human');
            const [characterClass, setCharacterClass] = useState('Fighter');
            const [level, setLevel] = useState(1);
            const [str, setStr] = useState(10);
            const [dex, setDex] = useState(10);
            const [con, setCon] = useState(10);
            const [int, setInt] = useState(10);
            const [wis, setWis] = useState(10);
            const [cha, setCha] = useState(10);

            const races = ['Dwarf', 'Elf', 'Halfling', 'Human', 'Dragonborn', 'Gnome', 'Half-Elf', 'Half-Orc', 'Tiefling'];
            const classes = ['Barbarian', 'Bard', 'Cleric', 'Druid', 'Fighter', 'Monk', 'Paladin', 'Ranger', 'Rogue', 'Sorcerer', 'Warlock', 'Wizard'];

            const rollStats = () => {
                const roll = () => {
                    const rolls = [1,2,3,4].map(() => Math.floor(Math.random() * 6) + 1);
                    rolls.sort();
                    return rolls[1] + rolls[2] + rolls[3];
                };
                setStr(roll());
                setDex(roll());
                setCon(roll());
                setInt(roll());
                setWis(roll());
                setCha(roll());
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const conMod = Math.floor((con - 10) / 2);
                const dexMod = Math.floor((dex - 10) / 2);
                const maxHP = 10 + conMod;

                onCreate({
                    name, race, character_class: characterClass, level,
                    strength: str, dexterity: dex, constitution: con,
                    intelligence: int, wisdom: wis, charisma: cha,
                    hit_points_max: maxHP, hit_points_current: maxHP,
                    armor_class: 10 + dexMod, initiative: dexMod, speed: 30,
                    conditions: []
                });
            };

            const mod = (score) => Math.floor((score - 10) / 2);

            return (
                <div className="min-h-screen bg-gray-50 py-8">
                    <div className="max-w-4xl mx-auto px-4">
                        <button onClick={onBack} className="mb-6 px-4 py-2 text-gray-600 hover:text-gray-900">
                            ‚Üê Back
                        </button>

                        <h1 className="text-3xl font-bold text-gray-900 mb-8">Create New Character</h1>

                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="bg-white rounded-lg shadow-md p-6">
                                <h2 className="text-xl font-bold mb-4">Basic Information</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                                        <input type="text" required className="w-full px-4 py-2 border border-gray-300 rounded-lg" value={name} onChange={(e) => setName(e.target.value)} />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Level</label>
                                        <input type="number" min="1" max="20" className="w-full px-4 py-2 border border-gray-300 rounded-lg" value={level} onChange={(e) => setLevel(parseInt(e.target.value))} />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Race</label>
                                        <select className="w-full px-4 py-2 border border-gray-300 rounded-lg" value={race} onChange={(e) => setRace(e.target.value)}>
                                            {races.map(r => <option key={r} value={r}>{r}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Class</label>
                                        <select className="w-full px-4 py-2 border border-gray-300 rounded-lg" value={characterClass} onChange={(e) => setCharacterClass(e.target.value)}>
                                            {classes.map(c => <option key={c} value={c}>{c}</option>)}
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white rounded-lg shadow-md p-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold">Ability Scores</h2>
                                    <button type="button" onClick={rollStats} className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                                        üé≤ Roll 4d6 (drop lowest)
                                    </button>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                                    {[
                                        { label: 'Strength', value: str, setValue: setStr },
                                        { label: 'Dexterity', value: dex, setValue: setDex },
                                        { label: 'Constitution', value: con, setValue: setCon },
                                        { label: 'Intelligence', value: int, setValue: setInt },
                                        { label: 'Wisdom', value: wis, setValue: setWis },
                                        { label: 'Charisma', value: cha, setValue: setCha }
                                    ].map(ability => (
                                        <div key={ability.label} className="bg-gray-50 p-4 rounded-lg">
                                            <label className="block text-sm font-medium text-gray-700 mb-2">{ability.label}</label>
                                            <input type="number" min="1" max="20" className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" value={ability.value} onChange={(e) => ability.setValue(parseInt(e.target.value) || 10)} />
                                            <p className="text-center text-2xl font-bold text-blue-600">{mod(ability.value) >= 0 ? '+' : ''}{mod(ability.value)}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="flex justify-end space-x-4">
                                <button type="button" onClick={onBack} className="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                                    Cancel
                                </button>
                                <button type="submit" className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                    Create Character
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<Dashboard />, document.getElementById('root'));
    </script>
</body>
</html>

